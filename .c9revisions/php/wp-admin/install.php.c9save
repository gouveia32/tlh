{"ts":1380917916260,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php\n/**\n * WordPress Installer\n *\n * @package WordPress\n * @subpackage Administration\n */\n\n// Sanity check.\nif ( false ) {\n?>\n<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n\t<title>Error: PHP is not running</title>\n</head>\n<body class=\"wp-core-ui\">\n\t<h1 id=\"logo\"><a href=\"http://wordpress.org/\">WordPress</a></h1>\n\t<h2>Error: PHP is not running</h2>\n\t<p>WordPress requires that your web server is running PHP. Your server does not have PHP installed, or PHP is turned off.</p>\n</body>\n</html>\n<?php\n}\n\n/**\n * We are installing WordPress.\n *\n * @since 1.5.1\n * @var bool\n */\ndefine( 'WP_INSTALLING', true );\n\n/** Load WordPress Bootstrap */\nrequire_once( dirname( dirname( __FILE__ ) ) . '/wp-load.php' );\n\n/** Load WordPress Administration Upgrade API */\nrequire_once( dirname( __FILE__ ) . '/includes/upgrade.php' );\n\n/** Load wpdb */\nrequire_once(dirname(dirname(__FILE__)) . '/wp-includes/wp-db.php');\n\n$step = isset( $_GET['step'] ) ? (int) $_GET['step'] : 0;\n\n/**\n * Display install header.\n *\n * @since 2.5.0\n * @package WordPress\n * @subpackage Installer\n */\nfunction display_header() {\n\theader( 'Content-Type: text/html; charset=utf-8' );\n?>\n<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\" <?php language_attributes(); ?>>\n<head>\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n\t<title><?php _e( 'WordPress &rsaquo; Installation' ); ?></title>\n\t<?php\n\twp_admin_css( 'install', true );\n\t?>\n</head>\n<body class=\"wp-core-ui<?php if ( is_rtl() ) echo ' rtl'; ?>\">\n<h1 id=\"logo\"><a href=\"<?php echo esc_url( __( 'http://wordpress.org/' ) ); ?>\"><?php _e( 'WordPress' ); ?></a></h1>\n\n<?php\n} // end display_header()\n\n/**\n * Display installer setup form.\n *\n * @since 2.8.0\n * @package WordPress\n * @subpackage Installer\n */\nfunction display_setup_form( $error = null ) {\n\tglobal $wpdb;\n\t$user_table = ( $wpdb->get_var(\"SHOW TABLES LIKE '$wpdb->users'\") != null );\n\n\t// Ensure that Blogs appear in search engines by default\n\t$blog_public = 1;\n\tif ( ! empty( $_POST ) )\n\t\t$blog_public = isset( $_POST['blog_public'] );\n\n\t$weblog_title = isset( $_POST['weblog_title'] ) ? trim( wp_unslash( $_POST['weblog_title'] ) ) : '';\n\t$user_name = isset($_POST['user_name']) ? trim( wp_unslash( $_POST['user_name'] ) ) : 'admin';\n\t$admin_password = isset($_POST['admin_password']) ? trim( wp_unslash( $_POST['admin_password'] ) ) : '';\n\t$admin_email  = isset( $_POST['admin_email']  ) ? trim( wp_unslash( $_POST['admin_email'] ) ) : '';\n\n\tif ( ! is_null( $error ) ) {\n?>\n<p class=\"message\"><?php printf( __( '<strong>ERROR</strong>: %s' ), $error ); ?></p>\n<?php } ?>\n<form id=\"setup\" method=\"post\" action=\"install.php?step=2\">\n\t<table class=\"form-table\">\n\t\t<tr>\n\t\t\t<th scope=\"row\"><label for=\"weblog_title\"><?php _e( 'Site Title' ); ?></label></th>\n\t\t\t<td><input name=\"weblog_title\" type=\"text\" id=\"weblog_title\" size=\"25\" value=\"<?php echo esc_attr( $weblog_title ); ?>\" /></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<th scope=\"row\"><label for=\"user_login\"><?php _e('Username'); ?></label></th>\n\t\t\t<td>\n\t\t\t<?php\n\t\t\tif ( $user_table ) {\n\t\t\t\t_e('User(s) already exists.');\n\t\t\t} else {\n\t\t\t\t?><input name=\"user_name\" type=\"text\" id=\"user_login\" size=\"25\" value=\"<?php echo esc_attr( sanitize_user( $user_name, true ) ); ?>\" />\n\t\t\t\t<p><?php _e( 'Usernames can have only alphanumeric characters, spaces, underscores, hyphens, periods and the @ symbol.' ); ?></p>\n\t\t\t<?php\n\t\t\t} ?>\n\t\t\t</td>\n\t\t</tr>\n\t\t<?php if ( ! $user_table ) : ?>\n\t\t<tr>\n\t\t\t<th scope=\"row\">\n\t\t\t\t<label for=\"admin_password\"><?php _e('Password, twice'); ?></label>\n\t\t\t\t<p><?php _e('A password will be automatically generated for you if you leave this blank.'); ?></p>\n\t\t\t</th>\n\t\t\t<td>\n\t\t\t\t<input name=\"admin_password\" type=\"password\" id=\"pass1\" size=\"25\" value=\"\" />\n\t\t\t\t<p><input name=\"admin_password2\" type=\"password\" id=\"pass2\" size=\"25\" value=\"\" /></p>\n\t\t\t\t<div id=\"pass-strength-result\"><?php _e('Strength indicator'); ?></div>\n\t\t\t\t<p><?php _e('Hint: The password should be at least seven characters long. To make it stronger, use upper and lower case letters, numbers and symbols like ! \" ? $ % ^ &amp; ).'); ?></p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<?php endif; ?>\n\t\t<tr>\n\t\t\t<th scope=\"row\"><label for=\"admin_email\"><?php _e( 'Your E-mail' ); ?></label></th>\n\t\t\t<td><input name=\"admin_email\" type=\"text\" id=\"admin_email\" size=\"25\" value=\"<?php echo esc_attr( $admin_email ); ?>\" />\n\t\t\t<p><?php _e( 'Double-check your email address before continuing.' ); ?></p></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<th scope=\"row\"><label for=\"blog_public\"><?php _e( 'Privacy' ); ?></label></th>\n\t\t\t<td colspan=\"2\"><label><input type=\"checkbox\" name=\"blog_public\" value=\"1\" <?php checked( $blog_public ); ?> /> <?php _e( 'Allow search engines to index this site.' ); ?></label></td>\n\t\t</tr>\n\t</table>\n\t<p class=\"step\"><input type=\"submit\" name=\"Submit\" value=\"<?php esc_attr_e( 'Install WordPress' ); ?>\" class=\"button button-large\" /></p>\n</form>\n<?php\n} // end display_setup_form()\n\n// Let's check to make sure WP isn't already installed.\nif ( is_blog_installed() ) {\n\tdisplay_header();\n\tdie( '<h1>' . __( 'Already Installed' ) . '</h1><p>' . __( 'You appear to have already installed WordPress. To reinstall please clear your old database tables first.' ) . '</p><p class=\"step\"><a href=\"../wp-login.php\" class=\"button button-large\">' . __( 'Log In' ) . '</a></p></body></html>' );\n}\n\n$php_version    = phpversion();\n$mysql_version  = $wpdb->db_version();\n$php_compat     = version_compare( $php_version, $required_php_version, '>=' );\n$mysql_compat   = version_compare( $mysql_version, $required_mysql_version, '>=' ) || file_exists( WP_CONTENT_DIR . '/db.php' );\n\nif ( !$mysql_compat && !$php_compat )\n\t$compat = sprintf( __( 'You cannot install because <a href=\"http://codex.wordpress.org/Version_%1$s\">WordPress %1$s</a> requires PHP version %2$s or higher and MySQL version %3$s or higher. You are running PHP version %4$s and MySQL version %5$s.' ), $wp_version, $required_php_version, $required_mysql_version, $php_version, $mysql_version );\nelseif ( !$php_compat )\n\t$compat = sprintf( __( 'You cannot install because <a href=\"http://codex.wordpress.org/Version_%1$s\">WordPress %1$s</a> requires PHP version %2$s or higher. You are running version %3$s.' ), $wp_version, $required_php_version, $php_version );\nelseif ( !$mysql_compat )\n\t$compat = sprintf( __( 'You cannot install because <a href=\"http://codex.wordpress.org/Version_%1$s\">WordPress %1$s</a> requires MySQL version %2$s or higher. You are running version %3$s.' ), $wp_version, $required_mysql_version, $mysql_version );\n\nif ( !$mysql_compat || !$php_compat ) {\n\tdisplay_header();\n\tdie( '<h1>' . __( 'Insufficient Requirements' ) . '</h1><p>' . $compat . '</p></body></html>' );\n}\n\nif ( ! is_string( $wpdb->base_prefix ) || '' === $wpdb->base_prefix ) {\n\tdisplay_header();\n\tdie( '<h1>' . __( 'Configuration Error' ) . '</h1><p>' . __( 'Your <code>wp-config.php</code> file has an empty database table prefix, which is not supported.' ) . '</p></body></html>' );\n}\n\nswitch($step) {\n\tcase 0: // Step 1\n\tcase 1: // Step 1, direct link.\n\t  display_header();\n?>\n<h1><?php _ex( 'Welcome', 'Howdy' ); ?></h1>\n<p><?php printf( __( 'Welcome to the famous five minute WordPress installation process! You may want to browse the <a href=\"%s\">ReadMe documentation</a> at your leisure. Otherwise, just fill in the information below and you&#8217;ll be on your way to using the most extendable and powerful personal publishing platform in the world.' ), '../readme.html' ); ?></p>\n\n<h1><?php _e( 'Information needed' ); ?></h1>\n<p><?php _e( 'Please provide the following information. Don&#8217;t worry, you can always change these settings later.' ); ?></p>\n\n<?php\n\t\tdisplay_setup_form();\n\t\tbreak;\n\tcase 2:\n\t\tif ( ! empty( $wpdb->error ) )\n\t\t\twp_die( $wpdb->error->get_error_message() );\n\n\t\tdisplay_header();\n\t\t// Fill in the data we gathered\n\t\t$weblog_title = isset( $_POST['weblog_title'] ) ? trim( wp_unslash( $_POST['weblog_title'] ) ) : '';\n\t\t$user_name = isset($_POST['user_name']) ? trim( wp_unslash( $_POST['user_name'] ) ) : 'admin';\n\t\t$admin_password = isset($_POST['admin_password']) ? wp_unslash( $_POST['admin_password'] ) : '';\n\t\t$admin_password_check = isset($_POST['admin_password2']) ? wp_unslash( $_POST['admin_password2'] ) : '';\n\t\t$admin_email  = isset( $_POST['admin_email']  ) ?trim( wp_unslash( $_POST['admin_email'] ) ) : '';\n\t\t$public       = isset( $_POST['blog_public']  ) ? (int) $_POST['blog_public'] : 0;\n\t\t// check e-mail address\n\t\t$error = false;\n\t\tif ( empty( $user_name ) ) {\n\t\t\t// TODO: poka-yoke\n\t\t\tdisplay_setup_form( __('you must provide a valid username.') );\n\t\t\t$error = true;\n\t\t} elseif ( $user_name != sanitize_user( $user_name, true ) ) {\n\t\t\tdisplay_setup_form( __('the username you provided has invalid characters.') );\n\t\t\t$error = true;\n\t\t} elseif ( $admin_password != $admin_password_check ) {\n\t\t\t// TODO: poka-yoke\n\t\t\tdisplay_setup_form( __( 'your passwords do not match. Please try again' ) );\n\t\t\t$error = true;\n\t\t} else if ( empty( $admin_email ) ) {\n\t\t\t// TODO: poka-yoke\n\t\t\tdisplay_setup_form( __( 'you must provide an e-mail address.' ) );\n\t\t\t$error = true;\n\t\t} elseif ( ! is_email( $admin_email ) ) {\n\t\t\t// TODO: poka-yoke\n\t\t\tdisplay_setup_form( __( 'that isn&#8217;t a valid e-mail address. E-mail addresses look like: <code>username@example.com</code>' ) );\n\t\t\t$error = true;\n\t\t}\n\n\t\tif ( $error === false ) {\n\t\t\t$wpdb->show_errors();\n\t\t\t$result = wp_install($weblog_title, $user_name, $admin_email, $public, '', $admin_password);\n\t\t\textract( $result, EXTR_SKIP );\n?>\n\n<h1><?php _e( 'Success!' ); ?></h1>\n\n<p><?php _e( 'WordPress has been installed. Were you expecting more steps? Sorry to disappoint.' ); ?></p>\n\n<table class=\"form-table install-success\">\n\t<tr>\n\t\t<th><?php _e( 'Username' ); ?></th>\n\t\t<td><?php echo esc_html( sanitize_user( $user_name, true ) ); ?></td>\n\t</tr>\n\t<tr>\n\t\t<th><?php _e( 'Password' ); ?></th>\n\t\t<td><?php\n\t\tif ( ! empty( $password ) && empty($admin_password_check) )\n\t\t\techo '<code>'. esc_html($password) .'</code><br />';\n\t\techo \"<p>$password_message</p>\"; ?>\n\t\t</td>\n\t</tr>\n</table>\n\n<p class=\"step\"><a href=\"../wp-login.php\" class=\"button button-large\"><?php _e( 'Log In' ); ?></a></p>\n\n<?php\n\t\t}\n\t\tbreak;\n}\n?>\n<script type=\"text/javascript\">var t = document.getElementById('weblog_title'); if (t){ t.focus(); }</script>\n<?php wp_print_scripts( 'user-profile' ); ?>\n</body>\n</html>\n"]],"start1":0,"start2":0,"length1":0,"length2":10447}]],"length":10447}
{"contributors":[],"silentsave":false,"ts":1380917952082,"patch":[[{"diffs":[[0,"'Welcome"],[1," +++++"],[0,"', 'Howd"]],"start1":7164,"start2":7164,"length1":16,"length2":22}]],"length":10453,"saved":false}
